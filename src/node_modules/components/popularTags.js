import React, { useEffect } from 'react'

import useFetch from 'hooks/useFetch'
import Loading from 'components/loading'
import ErrorMessage from 'components/errorMessage'
import { NavLink } from 'react-router-dom'

const PopularTags = () => {
    const [{response, isLoading, error}, doFetch] = useFetch('tags')

    useEffect(() => {
        doFetch()
    }, [doFetch])

    if (isLoading || !response) {
        return <Loading />
    }
    if (error) {
        return <ErrorMessage />
    }

    const fixedArrayTags = response.tags.join(',').replace(/[^a-zа-яё0-9\s]/gi, ' ').trim().split(' ')

    return (
        <div className='sidebar'>
            <p>Popular tags</p>
            <div className='tag-list'>
                {fixedArrayTags.map(tag => {
                    return <NavLink to={`/tags/${tag}`} className='tag-default tag-pill' key={tag}>{tag}</NavLink>
                })}
            </div>
        </div>
    )
}

export default PopularTags